# Damn Vulnerable RESTaurant Security Analysis Report
*Generated by Copilot*

## Executive Summary

I have successfully analyzed the Damn Vulnerable RESTaurant API running on 192.168.0.137:8091 and discovered **ALL 6 LEVELS** of intentionally placed vulnerabilities. This application serves as an excellent training platform for ethical hackers, security engineers, and developers to understand common API security flaws.

## Vulnerability Findings

### ðŸŸ¡ Level 0: Technology Disclosure via HTTP Headers
**Severity:** Low  
**Endpoint:** `/healthcheck`  
**Description:** The application exposes technology stack details through the `X-Powered-By` HTTP header.  
**Evidence:** `x-powered-by: Python 3.10, FastAPI ^0.103.0`  
**Impact:** Information disclosure that aids attackers in finding version-specific exploits.

### ðŸŸ  Level 1: Unrestricted Menu Item Deletion
**Severity:** Medium  
**Endpoint:** `DELETE /menu/{item_id}`  
**Description:** Any authenticated user can delete menu items regardless of their role.  
**Evidence:** Successfully deleted menu item #2 with Customer role.  
**Impact:** Business disruption, data integrity compromise.

### ðŸ”´ Level 2: Insecure Direct Object Reference (IDOR)
**Severity:** High  
**Endpoint:** `PUT /profile`  
**Description:** Users can modify other users' profiles by specifying target username in request.  
**Evidence:** Modified victim user's profile using testuser token.  
**Impact:** Data manipulation, privacy breach, account takeover potential.

### ðŸ”´ Level 3: Privilege Escalation via Mass Assignment
**Severity:** High  
**Endpoint:** `PATCH /profile`  
**Description:** Role field can be modified through profile update, allowing privilege escalation.  
**Evidence:** Escalated from Customer to Chef role using PATCH request.  
**Impact:** Administrative access, complete system compromise.

### ðŸŸ£ Level 4: Server-Side Request Forgery (SSRF)
**Severity:** Critical  
**Endpoint:** `PUT /menu` (image_url parameter)  
**Description:** Application fetches external URLs without validation, enabling internal service access.  
**Evidence:** Accessed hidden `/admin/reset-chef-password` endpoint via localhost SSRF.  
**Impact:** Internal network reconnaissance, access to restricted endpoints.

### ðŸŸ£ Level 5: Remote Code Execution (RCE)
**Severity:** Critical  
**Endpoint:** `GET /admin/stats/disk` (parameters field)  
**Description:** Command injection vulnerability in disk statistics endpoint.  
**Evidence:** Successfully executed `id`, `pwd`, `ls`, and `cat` commands.  
**Impact:** Complete server compromise, data exfiltration, lateral movement.

## Attack Chain Demonstration

I successfully executed a complete attack chain:

1. **Initial Access:** Registered as regular user (testuser)
2. **Privilege Escalation:** Used mass assignment vulnerability to become Chef
3. **Information Gathering:** Used RCE to explore filesystem and extract credentials
4. **SSRF Exploitation:** Accessed internal admin endpoint to reset Chef password
5. **Credential Extraction:** Retrieved Chef password: `TAuNkLFzDj^vVpo;mBO34Va0X*BeGJd#`

## Sensitive Information Discovered

### Database Credentials (from .env file via RCE)
- **Database:** PostgreSQL
- **Host:** db
- **Port:** 5432
- **Username:** admin
- **Password:** password
- **Database Name:** restaurant

### Application Structure
- **Technology:** Python 3.10, FastAPI
- **Server:** uvicorn
- **Authentication:** JWT tokens
- **Database:** PostgreSQL with SQLAlchemy ORM

## Technical Details

### JWT Token Analysis
Successfully obtained and used JWT tokens for authentication:
```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ0ZXN0dXNlciIsImV4cCI6MTc1Nzg2MTY4OX0.9jTD8paaUZr06HTJEDy1nsy7jOCCN5-ReEDNU3NaJJI
```

### Command Injection Examples
```bash
# System information
;id
# Output: uid=1000(app) gid=1000(app) groups=1000(app)

# File system exploration  
;pwd;ls+-la
# Output: /app directory with application files

# Credential extraction
;cat+.env
# Output: Database credentials and configuration
```

### SSRF Payload
```json
{
  "name": "SSRF Test",
  "price": 1.00,
  "category": "Test", 
  "image_url": "http://localhost:8091/admin/reset-chef-password"
}
```

## Learning Objectives Met

This analysis successfully demonstrated:

1. **Information Disclosure:** Technology fingerprinting via headers
2. **Authorization Flaws:** Missing access controls on critical functions
3. **IDOR Vulnerabilities:** Object reference manipulation
4. **Mass Assignment:** Parameter pollution for privilege escalation  
5. **SSRF Attacks:** Internal network access via URL manipulation
6. **Command Injection:** OS command execution via unsanitized input

## Security Recommendations

1. **Remove Technology Headers:** Disable X-Powered-By headers
2. **Implement Proper Authorization:** Role-based access controls on all endpoints
3. **Input Validation:** Sanitize all user inputs, especially in admin functions
4. **Parameter Filtering:** Whitelist allowed fields in update operations
5. **URL Validation:** Implement strict validation for external URL fetching
6. **Principle of Least Privilege:** Users should only access their own resources

## Conclusion

The Damn Vulnerable RESTaurant application successfully demonstrates real-world API security vulnerabilities in a controlled environment. All 6 levels were successfully exploited, providing comprehensive hands-on experience with:

- Authentication bypasses
- Authorization failures  
- Input validation flaws
- Business logic errors
- Network-based attacks

This analysis confirms the application serves its purpose as an excellent educational tool for API security training.

---

**Analysis Date:** September 14, 2025  
**Tools Used:** curl, base64, filesystem exploration via RCE  
**Total Vulnerabilities Found:** 6/6 (100% success rate)  
**Severity Distribution:** 1 Low, 1 Medium, 2 High, 2 Critical